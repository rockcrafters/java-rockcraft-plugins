name: ${name}
version: ${version}
summary: ${summary}
description: |
  ${description}

platforms:
  ${platforms}

base: bare
build-base: ubuntu@24.04

${service}

parts:
  gradle/rockcraft/dump:
    source: build/libs
    plugin: dump
    override-build: |
      mkdir -p ${CRAFT_PART_INSTALL}/jars
      ${copyoutput}

  gradle/rockcraft/runtime:
    after:
      - gradle/rockcraft/dump
      - deps
    plugin: jlink
    jlink-jars:
      ${output}

  deps:
    plugin: nil
    ${deps-source}
    override-build: |
      chisel cut --release ./ --root ${CRAFT_PART_INSTALL} libc6_libs \
        libgcc-s1_libs \
        libstdc++6_libs \
        zlib1g_libs \
        libnss3_libs \
        base-files_base ${deps}
      craftctl default
